<!DOCTYPE html>
<html>
<head>{include="includes"}</head>
<body>
{include="page.header"}
<div id="toolsdiv" class="page-tools container">
    <div class="row">
        <div class="col-md-6 col-md-offset-3">
            <div class="list">
                <h1 class="list-header">Settings</h1>
                <a class="list-item ripple" href="?do=configure">
                    <div class="row">
                        <div class="col-sm-2 col-xs-3">
                            <div class="round-image-container">
                                <img src="images/tools/settings.png" alt="Configure" />
                            </div>
                        </div>
                        <div class="col-sm-10 col-xs-9">
                            <div class="list-item-title">Configure your Shaarli</div>
                            <div class="list-item-subtitle">Change Title, timezone...</div>
                        </div>
                    </div>
                </a>
                {if="!$GLOBALS['config']['OPEN_SHAARLI']"}
                <a class="list-item ripple" href="?do=changepasswd">
                    <div class="row">
                        <div class="col-sm-2 col-xs-3">
                            <div class="round-image-container">
                                <img src="images/tools/lock_active.png" alt="Change password" />
                            </div>
                        </div>
                        <div class="col-sm-10 col-xs-9">
                            <div class="list-item-title">Change password</div>
                            <div class="list-item-subtitle">Change your password</div>
                        </div>
                    </div>
                </a>
                {/if}
                <a class="list-item ripple" href="?do=pluginadmin">
                    <div class="row">
                        <div class="col-sm-2 col-xs-3">
                            <div class="round-image-container">
                                <img src="images/tools/plugin.png" alt="Plugin admin" />
                            </div>
                        </div>
                        <div class="col-sm-10 col-xs-9">
                            <div class="list-item-title">Plugin administration</div>
                            <div class="list-item-subtitle">Enable, disable and configure your plugins</div>
                        </div>
                    </div>
                </a>
                <a class="list-item ripple" href="?do=changetag">
                    <div class="row">
                        <div class="col-sm-2 col-xs-3">
                            <div class="round-image-container">
                                <img src="images/tools/tag-text-outline.png" alt="Manage tags" />
                            </div>
                        </div>
                        <div class="col-sm-10 col-xs-9">
                            <div class="list-item-title">Tags</div>
                            <div class="list-item-subtitle">Rename or delete a tag in all links</div>
                        </div>
                    </div>
                </a>
                <a class="list-item ripple" href="?do=import">
                    <div class="row">
                        <div class="col-sm-2 col-xs-3">
                            <div class="round-image-container">
                                <img src="images/tools/import.png" alt="Import" />
                            </div>
                        </div>
                        <div class="col-sm-10 col-xs-9">
                            <div class="list-item-title">Import</div>
                            <div class="list-item-subtitle">Import Netscape html bookmarks (as exported from Firefox, Chrome, Opera, delicious...)</div>
                        </div>
                    </div>
                </a>
                <a class="list-item ripple" href="?do=export">
                    <div class="row">
                        <div class="col-sm-2 col-xs-3">
                            <div class="round-image-container">
                                <img src="images/tools/export.png" alt="Export" />
                            </div>
                        </div>
                        <div class="col-sm-10 col-xs-9">
                            <div class="list-item-title">Export</div>
                            <div class="list-item-subtitle">Export Netscape html bookmarks (which can be imported in Firefox, Chrome, Opera, delicious...)</div>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
    {if="isset($tools_plugin)"}
    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <hr class="darker"/>
            <h2 class="mtm">Plugin settings</h2>
            {loop="$tools_plugin"}
                {$value}
            {/loop}
        </div>
    </div>
    {/if}
    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <hr class="darker"/>
            <h2 class="mtm">Bookmarklet</h2>
            <p>You can easily bookmark links from anywhere on the web via bookrmalets right below.</p>
            <p>They can be dragged and dropped among your browser's bookmarks. Then, you just have to click on them from your bookmarks menu.</p>
            <div class="row">
                <div class="col-xs-6 text-center">
                    <a class="bookmarklet" onclick="alert('Drag this link to your bookmarks toolbar, or right-click it and choose Bookmark This Link...');return false;" href="javascript:javascript:(function(){var%20url%20=%20location.href;var%20title%20=%20document.title%20||%20url;window.open('{$pageabsaddr}?post='%20+%20encodeURIComponent(url)+'&amp;title='%20+%20encodeURIComponent(title)+'&amp;description='%20+%20encodeURIComponent(document.getSelection())+'&amp;source=bookmarklet','_blank','menubar=no,height=650,width=600,toolbar=no,scrollbars=no,status=no,dialog=1');})();">
                        <img src="images/tools/star-circle.png" alt="Favicon" /> +Shaare link
                    </a>
                </div>
                <div class="col-xs-6 text-center">
                    <a class="bookmarklet" onclick="alert('Drag this link to your bookmarks toolbar, or right-click it and choose Bookmark This Link...');return false;" href="?private=1&post=">
                        <img src="images/tools/star-circle.png" alt="Favicon" /> +Add Note
                    </a>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <hr class="darker"/>
            <h2 class="mtm" id="firefox-api-title">Firefox Social API integration</h2>
            <p>Adds Shaarli to the <em>Share this page</em> button in Firefox.</p>
            <div class="row">
                <div class="col-xs-12 text-center">
                    <button type="button" id="firefoxsocial" class="firefoxsocial button-raised button-firefox" >
                        Activate Now
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{include="page.footer"}
<script>
(function(){
    function activateFirefoxSocial(node) {
        var loc = location.href;
        var baseURL = loc.substring(0, loc.lastIndexOf("/"));
        // Keeping the data separated (ie. not in the DOM) so that it's maintainable and diffable.
        var data = {
            name: "{$shaarlititle}",
            description: "The personal, minimalist, super-fast, no-database delicious clone.",
            author: "Shaarli",
            version: "1.0.0",
            iconURL: baseURL + "/tpl/material/images/favicons/favicon-96x96.png",
            icon32URL: baseURL + "/tpl/material/images/favicons/favicon-32x32.png",
            icon64URL: baseURL + "/tpl/material/images/favicons/favicon-64x64.png",
            shareURL: baseURL + "{noparse}?post=%{url}&title=%{title}&description=%{description}&source=firefoxsocialapi{/noparse}",
            homepageURL: baseURL
        };
        node.setAttribute("data-service", JSON.stringify(data));
        var activate = new CustomEvent("ActivateSocialFeature");
        node.dispatchEvent(activate);
    }

    $(document).ready(function(){
        // Hack taken from https://stackoverflow.com/questions/9847580/how-to-detect-safari-chrome-ie-firefox-and-opera-browser
        var isFirefox = typeof InstallTrigger !== 'undefined';
        if(!isFirefox || window.location.protocol.indexOf('https') < 0){
            $('#firefoxsocial').attr('disabled', 'disabled');
            var message = $("<p></p>")
                .addClass('highlight')
                .html('You need to use Firefox over <strong>https</strong> to use this functionality.');
            $('#firefox-api-title').after(message);
        } else{
            // Attach events to the Firefox Social button.
            $('#firefoxsocial').on('click', function(){
                activateFirefoxSocial(this);
            });
        }
    });
})();
</script>
</body>
</html>
